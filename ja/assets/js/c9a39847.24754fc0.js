"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1643],{54192:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"study/Programing/Knowhow/terraform","title":"\u74b0\u5883\u5dee\u7570\u306b\u3088\u308b terraform \u5dee\u5206\u306e\u89e3\u6d88\u65b9\u6cd5","description":"\u306a\u305c\u66f8\u3044\u3066\u3044\u308b\u304b","source":"@site/docs/study/Programing/Knowhow/09_terraform.md","sourceDirName":"study/Programing/Knowhow","slug":"/study/Programing/Knowhow/terraform","permalink":"/training/ja/docs/study/Programing/Knowhow/terraform","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1743416353000,"sidebarPosition":9,"frontMatter":{},"sidebar":"study","previous":{"title":"\u76ee\u6a19\u8a2d\u5b9a\u3084\u8a55\u4fa1\u306e\u66f8\u5f0f(\u81ea\u5206\u7528\u30e1\u30e2)","permalink":"/training/ja/docs/study/Programing/Knowhow/target-settings"},"next":{"title":"node_modules\u306e\u624b\u52d5\u4fee\u6b63\u3068\u305d\u306e\u5c55\u958b\u65b9\u6cd5\u306b\u3064\u3044\u3066\ud83d\udd30","permalink":"/training/ja/docs/study/Programing/Knowhow/node_modules"}}');var r=a(74848),o=a(28453);const s={},i="\u74b0\u5883\u5dee\u7570\u306b\u3088\u308b terraform \u5dee\u5206\u306e\u89e3\u6d88\u65b9\u6cd5",d={},l=[{value:"\u306a\u305c\u66f8\u3044\u3066\u3044\u308b\u304b",id:"\u306a\u305c\u66f8\u3044\u3066\u3044\u308b\u304b",level:2},{value:"\u30ed\u30b0",id:"\u30ed\u30b0",level:2},{value:"\u539f\u56e0\u30fb\u5bfe\u7b56",id:"\u539f\u56e0\u5bfe\u7b56",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components},{Details:a}=e;return a||function(n,e){throw new Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u74b0\u5883\u5dee\u7570\u306b\u3088\u308b-terraform-\u5dee\u5206\u306e\u89e3\u6d88\u65b9\u6cd5",children:"\u74b0\u5883\u5dee\u7570\u306b\u3088\u308b terraform \u5dee\u5206\u306e\u89e3\u6d88\u65b9\u6cd5"})}),"\n",(0,r.jsx)(e.h2,{id:"\u306a\u305c\u66f8\u3044\u3066\u3044\u308b\u304b",children:"\u306a\u305c\u66f8\u3044\u3066\u3044\u308b\u304b"}),"\n",(0,r.jsxs)(e.p,{children:["PJ \u3067\u5909\u66f4\u304c\u306a\u3044\u306b\u3082\u95a2\u308f\u3089\u305a\u3001",(0,r.jsx)(e.code,{children:"terraform plan"}),"\u5b9f\u884c\u6642\u306b\u4f59\u8a08\u306a\u5dee\u5206\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u3002\u3053\u306e\u5dee\u5206\u306e\u89e3\u6d88\u65b9\u6cd5\u306b\u95a2\u3057\u3066\u30e1\u30e2\u3057\u3066\u304a\u304f\u305f\u3081\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"\u30ed\u30b0",children:"\u30ed\u30b0"}),"\n",(0,r.jsx)(e.p,{children:"\u4ee5\u4e0b\u304c\u30ed\u30b0"}),"\n",(0,r.jsxs)(a,{children:[(0,r.jsx)("summary",{children:"\u5168\u6587\u3092\u8868\u793a"}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'...\u5dee\u5206\u591a\u3044\u306e\u3067\u9069\u5f53\u306b\u7701\u7565\n# data.aws_iam_policy_document.XXXXwill be read during apply\n  # (depends on a resource or a module with changes pending)\n <= data "aws_iam_policy_document" "XXXX" {\n      + id   = (known after apply)\n      + json = (known after apply)\n\n      + statement {\n          + actions   = [\n              + "s3:GetObject",\n            ]\n          + effect    = "Allow"\n          + resources = [\n              + "arn:aws:s3:::XXXX",\n              + "arn:aws:s3:::XXXX/*",\n            ]\n          + sid       = "Allow CloudFront"\n\n          + condition {\n              + test     = "StringEquals"\n              + values   = [\n                  + "arn:aws:cloudfront::XXXXX",\n                ]\n              + variable = "aws:SourceArn"\n            }\n\n          + principals {\n              + identifiers = [\n                  + "cloudfront.amazonaws.com",\n                ]\n              + type        = "Service"\n            }\n        }\n    }\n\n# aws_cloudfront_distribution.XXXXX-cfd will be updated in-place\n\n~ resource "aws_cloudfront_distribution" "XXXXXXX-cfd" {\nid = "XXXXXXXX"\ntags = {\n"Name" = "XXXXXX-cfd"\n"company" = "XXXX"\n"environment_type" = "dev"\n"project_name" = "XXXX XXXX"\n"source_by" = "terraform"\n} # (21 unchanged attributes hidden)\n\n      ~ default_cache_behavior {\n            # (12 unchanged attributes hidden)\n\n          - lambda_function_association {\n              - event_type   = "viewer-request" -> null\n              - include_body = true -> null\n              - lambda_arn   = "arn:aws:lambda:us-east-1:XXXXX" -> null\n            }\n          + lambda_function_association {\n              + event_type   = "viewer-request"\n              + include_body = true\n              + lambda_arn   = (known after apply)\n            }\n        }\n\n      ~ ordered_cache_behavior {\n            # (13 unchanged attributes hidden)\n\n          - lambda_function_association {\n              - event_type   = "viewer-request" -> null\n              - include_body = true -> null\n              - lambda_arn   = "arn:aws:lambda:us-east-1:XXXXXX" -> null\n            }\n          + lambda_function_association {\n              + event_type   = "viewer-request"\n              + include_body = true\n              + lambda_arn   = (known after apply)\n            }\n        }\n      ~ ordered_cache_behavior {\n            # (13 unchanged attributes hidden)\n\n          - lambda_function_association {\n              - event_type   = "viewer-request" -> null\n              - include_body = true -> null\n              - lambda_arn   = "arn:aws:lambda:us-east-1:XXXXX" -> null\n            }\n          + lambda_function_association {\n              + event_type   = "viewer-request"\n              + include_body = true\n              + lambda_arn   = (known after apply)\n            }\n        }\n      ~ ordered_cache_behavior {\n            # (13 unchanged attributes hidden)\n\n          - lambda_function_association {\n              - event_type   = "viewer-request" -> null\n              - include_body = true -> null\n              - lambda_arn   = "arn:aws:lambda:us-east-1:XXXXX" -> null\n            }\n          + lambda_function_association {\n              + event_type   = "viewer-request"\n              + include_body = true\n              + lambda_arn   = (known after apply)\n            }\n        }\n      ~ ordered_cache_behavior {\n            # (13 unchanged attributes hidden)\n\n          - lambda_function_association {\n              - event_type   = "viewer-request" -> null\n              - include_body = true -> null\n              - lambda_arn   = "arn:aws:lambda:us-east-1:XXXXXX" -> null\n            }\n          + lambda_function_association {\n              + event_type   = "viewer-request"\n              + include_body = true\n              + lambda_arn   = (known after apply)\n            }\n        }\n      ~ ordered_cache_behavior {\n            # (13 unchanged attributes hidden)\n\n          - lambda_function_association {\n              - event_type   = "viewer-request" -> null\n              - include_body = true -> null\n              - lambda_arn   = "arn:aws:lambda:us-east-1:XXXXX" -> null\n            }\n          + lambda_function_association {\n              + event_type   = "viewer-request"\n              + include_body = true\n              + lambda_arn   = (known after apply)\n            }\n        }\n\n        # (7 unchanged blocks hidden)\n    }\n\n\n# aws_lambda_function.tp-dynamodb-streams will be updated in-place\n\n~ resource "aws_lambda_function" "tp-dynamodb-streams" {\nid = "tp-dev-dynamodb-streams"\n~ last_modified = "2023-10-02T02:09:29.000+0000" -> (known after apply)\n~ qualified_arn = "arn:aws:lambda:ap-northeast-1:XXXXXX" -> (known after apply)\n~ qualified_invoke_arn = "arn:aws:apigateway:ap-northeast-1:lambda:path/2015-03-31/functions/arn:aws:lambda:ap-northeast-1:XXXXXX" -> (known after apply)\n~ source_code_hash = "AAAAAA" -> "BBBBB"\ntags = {\n"Name" = "tp-dynamodb-streams"\n"company" = "XXXX"\n"environment_type" = "dev"\n"project_name" = "XXXX XXXX"\n"source_by" = "terraform"\n}\n~ version = "29" -> (known after apply) # (16 unchanged attributes hidden)\n\n        # (4 unchanged blocks hidden)\n    }\n\n# aws_s3_bucket_policy.XXXXX will be updated in-place\n\n~ resource "aws_s3_bucket_policy" "XXXXX" {\nid = "XXXXX"\n~ policy = jsonencode(\n{ - Statement = [ - { - Action = "s3:GetObject" - Condition = { - StringEquals = { - "aws:SourceArn" = "arn:aws:cloudfront::XXXXXX"\n}\n} - Effect = "Allow" - Principal = { - Service = "cloudfront.amazonaws.com"\n} - Resource = [\n\n- "arn:aws:s3:::XXXXXXX/\\*",\n- "arn:aws:s3:::XXXXXXX",\n  ] - Sid = "Allow CloudFront"\n  },\n  ] - Version = "2012-10-17"\n  }\n  ) -> (known after apply) # (1 unchanged attribute hidden)\n  }\n\n# aws_s3_bucket_policy.XXXXXX will be updated in-place\n\n~ resource "aws_s3_bucket_policy" "XXXXX" {\nid = "XXXXX"\n~ policy = jsonencode(\n{ - Statement = [ - { - Action = "s3:GetObject" - Condition = { - StringEquals = { - "aws:SourceArn" = "arn:aws:cloudfront::XXXXXX"\n}\n} - Effect = "Allow" - Principal = { - Service = "cloudfront.amazonaws.com"\n} - Resource = [\n\n- "arn:aws:s3:::XXXX/\\*",\n- "arn:aws:s3:::XXXX",\n  ] - Sid = "Allow CloudFront"\n  },\n  ] - Version = "2012-10-17"\n  }\n  ) -> (known after apply) # (1 unchanged attribute hidden)\n  }\n\n'})})]}),"\n",(0,r.jsx)(e.p,{children:"\u3053\u308c\u3092\u898b\u308b\u3068\u3001lambda \u306e sourceCodeHash \u304c\u5909\u308f\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u539f\u56e0\u306e\u69d8\u3060\u3063\u305f\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"\u539f\u56e0\u5bfe\u7b56",children:"\u539f\u56e0\u30fb\u5bfe\u7b56"}),"\n",(0,r.jsxs)(e.p,{children:["\u306a\u3093\u3067\u5909\u308f\u3063\u305f\u304b\u3001\u3053\u306e sourceCodeHash \u306f\u3069\u306e\u3088\u3046\u306b\u53d6\u5f97\u3057\u3066\u3044\u308b\u304b\u3068\u3044\u3046\u3068\u3001lambda \u306e\u30b3\u30fc\u30c9(\u4eca\u56de\u306f.js)\u3092 zip \u5316\u3057\u3066\u304b\u3089 hash \u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u3089\u3057\u3044(archive_file)\u304c\u3001",(0,r.jsx)("br",{}),"\nzip \u5316\u3057\u305f\u5f8c\u306e permission \u304c OS \u306b\u3088\u3063\u3066\u3001\u7570\u306a\u308b\u305f\u3081\u306b\u767a\u751f\u3057\u3066\u3044\u308b\u3089\u3057\u3044\u3002\u307e\u305f\u3001\u305d\u308c\u306b\u52a0\u3048\u3066\u3001.js \u306e\u6539\u884c\u30b3\u30fc\u30c9\u3082\u7d71\u4e00\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u306b\u3001\u7570\u306a\u308b sourceCodeHash \u304c\u751f\u6210\u3055\u308c\u3066\u3044\u305f\u6a21\u69d8\u3002"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.p,{children:"lambda \u4ee5\u5916\u306e\u5dee\u5206\u306f lambda \u306e sourceCodeHash \u306e\u5909\u66f4\u306b\u5f15\u3063\u5f35\u3089\u308c\u305f\u3082\u306e\u3067\u3042\u3063\u305f\u3002"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.p,{children:"\u3053\u306e\u305f\u3081\u3001\u8a72\u5f53\u306e.tf \u30d5\u30a1\u30a4\u30eb\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u3001\u5404.js \u30d5\u30a1\u30a4\u30eb\u306e\u6539\u884c\u30b3\u30fc\u30c9\u3092\u7d71\u4e00\u3057\u305f(LF \u3067\u904b\u7528\u3059\u308b\u3088\u3046\u306b\u3057\u305f)\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-tf",metastring:'title="lambda.tf"',children:'data "archive_file" "lambda" {\n  type        = "zip"\n  source_file = "lambda.js"\n  output_path = "lambda_XXXX.zip"\n+  output_file_mode = "0644"\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,r.jsx)(e.p,{children:"\u7b2c\u4e00\u30bd\u30fc\u30b9\u306b\u3064\u3044\u3066\u898b\u5931\u3063\u305f\u305f\u3081\u3001\u898b\u3064\u3051\u6b21\u7b2c\u8a18\u8f09\u4e88\u5b9a\u3002"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://zenn.dev/ikedam/articles/b98cb1acbb15de",children:"https://zenn.dev/ikedam/articles/b98cb1acbb15de"})}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}},28453:(n,e,a)=>{a.d(e,{R:()=>s,x:()=>i});var t=a(96540);const r={},o=t.createContext(r);function s(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);